# WF-03 — Script Draft

## Purpose
Script layihəsi hazırlanır və manifest-ə yazılır.

## Inputs
- Run Contract
- Script prompt (topic, keywords, sources)
- WF-10 `resolved_config`

## Outputs
- Run Contract yenilənmiş manifest

## Manifest update
- `script.draft` yazılır.
- `timestamps.phase = script_draft` və `timestamps.updated_at` yenilənir.
- `audit.change_log`-a “script drafted” yazılır.

## Error handling
- Script generation fail → retry (2 dəfə), sonra `script_generation_failed`.
- Script length invalid → `script_length_invalid`.
- Persist fail → retry (3 dəfə), sonra `update_failed`.
- Xəta baş verərsə `FAILED_WF_03`, `timestamps.phase = failed_wf_03` və audit qeyd yazılır.

## Test cases
1. Script yaradılır və `script.draft` dolur.
2. Script çox qısa olduqda validation error verir.
3. Persist fail simulyasiyası error statusu yaradır.
