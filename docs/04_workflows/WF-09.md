# WF-09 — Settings Panel

## Purpose
Konfiqurasiyaların və credentials-ların idarəsi üçün admin panel workflow-u.

## Inputs
- Admin UI form submissions
- Config import JSON

## Outputs
- Config DB/Data Table updates
- Audit log entries

## Nodes plan
1. **Trigger: Admin UI** — settings form submit.
2. **Node: Validate Input** — key/value/credential_ref format yoxlanır.
3. **Node: Enforce Credential Policy** — secret dəyərlər yalnız `credential_ref` olur.
4. **Node: Upsert DB Entry** — `ytb_settings` cədvəlinə yazılır.
5. **Node: Write Audit Log** — dəyişiklik log-u.
6. **Node: Notify Admin** — nəticə mesajı.

## Error handling
- Secret value plain text daxil edilərsə `secret_not_allowed`.
- Invalid environment → `invalid_environment`.
- DB write fail → retry (3 dəfə), sonra `settings_update_failed`.

## Test cases
1. `credential_ref` düzgün saxlanır və value boş olur.
2. Plain text secret daxil edildikdə error qaytarılır.
3. Environment `production` olmayan dəyər ilə error qaytarılır.
