# WF-09 — Settings Panel

## Purpose
Config və credentials idarəsi üçün admin panel workflow-u.

## Inputs
- Admin UI form submissions
- Config import JSON

## Outputs
- Config DB/Data Table updates
- Audit log response (`written_keys`, `action`, `scope`, `dry_run`, `settings_update_id`)

## Nodes plan
1. Trigger: Admin UI (Form)
2. Validate Input
3. Enforce Credential Policy
4. Upsert DB Entry (`ytb_settings`) və ya Dry-Run simulyasiyası
5. Write Audit Log
6. Notify Admin

## Error handling
- Secret plain text daxil edilərsə `secret_not_allowed`.
- `environment` düzgün deyilsə `invalid_environment`.
- DB write fail → retry (3 dəfə), sonra `settings_update_failed`.

## Test cases
1. `credential_ref` düzgün saxlanır və `value` boş qalır.
2. Plain text secret daxil edildikdə error qaytarılır.
3. `environment` yanlış olduqda error qaytarılır.
4. `dry_run = true` olduqda DB yazılmır və `written_keys` qaytarılır.
