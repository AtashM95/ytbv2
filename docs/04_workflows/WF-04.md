# WF-04 — Script Review & Approval

## Purpose
Ssenari yoxlanılır, düzəlişlər edilir və təsdiq olunur.

## Inputs
- Run Contract (`manifest.content.script`)
- Reviewer comments
- WF-10 Get Config output

## Outputs
- Run Contract yenilənmiş `manifest.content.script`
- Manifest `status.checks.script_reviewed = true`
- Manifest `status.phase = script_approved`

## Nodes plan
1. **Trigger: Reviewer UI** — review prosesi başlanır.
2. **Node: Get Config (WF-10)** — config alınır.
3. **Node: Display Script** — review üçün script göstərilir.
4. **Node: Apply Edits** — redaktə və düzəlişlər.
5. **Node: Mark Approved** — `script_reviewed = true`.
6. **Node: Persist Run Update** — run yenilənir.
7. **Node: Emit Event** — WF-05 üçün event.

## Error handling
- Reviewer input boş → `review_notes_required`.
- Approval skip → `approval_required`.
- Persist fail → retry (3 dəfə), sonra `update_failed`.

## Test cases
1. Script edit edilir və status `script_approved` olur.
2. Review notes boş olduqda error qaytarılır.
3. Persist fail simulyasiyası retry sayını göstərir.
