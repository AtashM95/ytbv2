# WF-04 — Script Review & Approval

## Purpose
Script yoxlanılır və təsdiqlənir.

## Inputs
- Run Contract
- Reviewer edits və notes
- WF-10 `resolved_config`

## Outputs
- Run Contract yenilənmiş manifest

## Manifest update
- `script.approved`, `script.review_notes`, `script.last_reviewed_at` yenilənir.
- `timestamps.phase = script_approved` və `timestamps.updated_at` yenilənir.
- `audit.change_log`-a “script approved” yazılır.

## Error handling
- Review notes boş → `review_notes_required`.
- Approval qeyd edilməzsə → `approval_required`.
- Persist fail → retry (3 dəfə), sonra `update_failed`.
- Xəta baş verərsə `FAILED_WF_04`, `timestamps.phase = failed_wf_04` və audit qeyd yazılır.

## Test cases
1. Script təsdiqlənir və `script.approved` dolur.
2. Review notes boş olduqda error qaytarılır.
3. Persist fail simulyasiyası retry siyasətini göstərir.
