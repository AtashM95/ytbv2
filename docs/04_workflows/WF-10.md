# WF-10 — Get Config

## Purpose
Config DB/Data Table-dan konfiqurasiyanı oxuyur, resolve edir və bütün workflow-lara eyni formatda verir.

## Inputs
- `environment` parametri (`dry_run`, `staging`, `production`)

## Outputs
- Vahid config output (`environment`, `settings`, `resolved_at`, `schema_version`)

## Nodes plan
1. **Trigger: HTTP Request or Internal Call** — config sorğusu.
2. **Node: Query Config DB** — `ytb_settings` entries.
3. **Node: Normalize Settings** — key-ləri nested strukturda birləşdirir.
4. **Node: Attach Credential Refs** — secrets yalnız `credential_ref` kimi.
5. **Node: Validate Required Keys** — critical keys yoxlanır.
6. **Node: Respond Output** — standart JSON qaytarılır.

## Error handling
- Config DB unreachable → `config_unavailable` statusu.
- Required key missing → `config_incomplete` statusu.
- Invalid environment → `invalid_environment` statusu.

## Test cases
1. `production` üçün config qaytarılır və `schema_version` mövcuddur.
2. Missing key olduqda `config_incomplete` qaytarılır.
3. DB connection fail simulyasiyası `config_unavailable` verir.
